# 数字逻辑与计算机组成

> 我也不好说是谁的问题，反正系统课我一个字也听不下去。
>
> 《数字逻辑与计算机组成》由南京大学袁春风主编，此书和系统所涉及的内容类似，所以选择用这本书作为 计算机系统I 学习的主线，在本文档中也会同步一些上课内容。

## 2. 数字逻辑基础

### 2.1.2 数字抽象

主要以 CMOS 逻辑电路为例。

CMOS 逻辑电路工作在 5 V 或更低的电源电压下，0~1.5 V 称为低电平；3.5~5.0 V 称为高电平；1.5~3.5 V 称为不确定状态。

- $V_{OHmin}$：输出为最高态时的最小输出电压值，一般为 $V_{cc}-0.1V$.
- $V_{OLmax}$：输出为最低态时的最大输出电压值，一般为 $V_{GND}+0.1V$.
- $V_{IHmin}$：输入端能识别为高态时的最小输入电压值，一般为 $0.7V_{cc}$.
- $V_{1Lmax}$：输入端能识别为低态时的最大输入电压值，一般为 $0.3V_{cc}$.

CMOS 的一大优点就是静态功耗较低，所以输出电压波动会比较小；而输入电压受外部其他电路电压不稳定等影响，所以波动会比较大。

**直流噪声容限（DC noise margin）**：所允许的最大噪声幅度，即在这个限度下前一级输出最坏还能保证后一级的输入能正常工作。（ $NM_h=V_{OHmin}-V_{IHmin}$ ）

### 2.1.3 CMOS 晶体管

晶体管三个端子分别称为栅极（gate）、源级（source）和漏极（drain），通过比较栅极和源极之间的电压差，来决定源极和漏极之间为截止还是导通。

- NMOS 晶体管：即 NPN 三级管，栅极为高电平时导通。
- PMOS 晶体管：即 PNP 三极管，栅极为低电平时导通。

通常较多输入端的门电路可用较小输入端的门电路级联而构成，反而速度更快、体积更小。一般来说输入端的数目不超过 8 个。

CMOS 非门、与非门、或非门都采用较少的晶体管电路来构造，统称为反相门。在这三种逻辑门的输出端再接一个非门，则可分别构成缓冲器、与门和或门。

**缓冲器**：输出和输入有相同的逻辑值，但是在时序上不同。

**传输门**：通过 CMOS 的截断和导通，实现开关的效果（一对 CMOS 晶体管，两个三极管）

### 2.1.4 CMOS 电路电气特性

#### 1. 转换时间

实际电路输出从低态到高态、从高态到低态都有转换时间，且上升时间和下降时间很可能不相同。

#### 2. 传输延迟

从输入信号发生变化到输出信号发生变化所需的时间。

#### 3. 功率损耗

- 静态损耗：数字电路在输出信号保持不变的功率损耗，CMOS 的静态损耗很低。
- 动态损耗：高低状态转换时的功率损耗。

### 2.3.3 逻辑函数的标准表示

- SOP（Sum of Product）：多个乘积项的或运算；“最小项”，变量仅在下标时取真值。
- POS（Product of Sum）：多个求和项的与运算；“最大项”，变量仅在下标时取非值。

### 2.4.2 卡诺图化简

- 格雷码，上下、左右、首尾都是相邻的单元；看圈时，一个圈对应的逻辑式——逻辑值不变的变量写进去，01 都有的变量不用写进去。
- 原则：圈少、圈大、不缺不漏。



## 5. FPGA 设计和硬件描述语言

- FPGA: Field Programmable Gate Array（现场可编程门阵列）
- ASIC: Application-Specific Integrated Circuit（专用集成电路）

![](https://github.com/Clovers2333/picx-images-hosting/raw/master/FGPA_intro.1zi0q2jm6a.webp)

CPU---GPU---FPGA/ASIC

对于并行运算，后面比前面强；通用性前面比后面强。

### 5.1.1 可编程逻辑器件（PLD）

- PROM 结构
- PLA 结构
- PAL 结构
- GAL 结构
- CPLD 结构

### 5.1.2 存储器阵列

#### 静态 RAM

#### 动态 RAM

#### ROM

### 5.1.3 FPGA 设计概述

- 基于查找表（Look-Up Table，LUT，巨大真值表）

### 5.2.2 基于 HDL 的数字电路设计流程

1. HDL 编码：编写各种 verilog 文件。
2. 仿真：利用 testbench，进行仿真。
3. 综合（Synthesis）：
    - 代码解析（parsing）
    - 多级综合（multi-level synthesis），将语言真正解析为电路描述（LUT？）
    - 工艺映射（technology mapping）：将电路描述进一步转换成工艺的标准单元（和晶元产商（物理板）提供的标准单元库对应）（映射文件 `top.v`，`nexysa7.xdc`?（这只是输入输出引脚映射））
4. 物理设计（vivado 里面的 Implement？）
    - 布局（mapping）：确定每个标准单元在三维空间中的位置。
    - 布线（routing）：在三维空间中通过物理走线将相应的标准单元连接起来。
    - 静态时序分析（static timing analysis）：根据标准单元和走线延时信息，报告最大频率和延时情况。
    - 电路规则与检查（如两根线太近而短路）
    - 生成物理结果（对于 FPGA，生成比特流文件）

### 5.3 Verilog 语言设计

详见 Verilog Cheatsheet.