## 二次型

### 索引

1. 引入——双线性函数
2. 二次型的定义
3. 矩阵相合的定义与性质
4. 二次型标准形的定义与求解
5. 相合规范形与惯性定理
6. 正定二次型与正定矩阵的定义
7. 例题选讲



### 引入——双线性函数

我们之前学习过相抵和相似，这两个概念都是从线性映射中引入的，那么对于二次型和相合矩阵，我们仍尝试从线性映射的角度来引入。

在之前的学习中，我们学习过线性映射 $f:V \to W$，如果 $W$ 是一个数域，我们就可以得到一个线性函数 $f: V \to F$；那么如果函数 $f$ 的自变量是两个向量呢？

> 我们称 $f$ 为线性空间 $V(F)$ 上的一个双线性函数，如果 $f$ 是 $V \times V$ 到 $F$ 的映射，而且 $\forall \alpha, \beta, \alpha_i, \beta_i \in V, k_i \in F (i = 1,2)$，均有：
>
> (1) $f(\alpha, k_1 \beta_1 + k_2 \beta_2) = k_1 f(\alpha, \beta_1) + k_2 f(\alpha, \beta_2),$
>
> (2) $f(k_1 \alpha_1 + k_2 \alpha_2, \beta) = k_1 f(\alpha_1, \beta) + k_2 f(\alpha_2, \beta).$

- 既然线性映射可以用一个矩阵来表示，那么双线性函数可不可以用一个矩阵表示呢？

设 $B = \{e_1,e_2,\cdots,e_n\}$ 是 $V(F)$ 的一组基，$V$ 中向量 $\alpha, \beta$ 关于基 $B$ 的坐标分别为：

$$
X = (x_1,\cdots,x_n)^T, \quad Y = (y_1,\cdots,y_n)^T
$$
即：
$$
\alpha = \sum_{i=1}^{n} x_i e_i, \quad \beta = \sum_{j=1}^{n} y_j e_j
$$
于是：
$$
f(\alpha, \beta) = f\left( \sum_{i=1}^{n} x_i e_i, \sum_{j=1}^{n} y_j e_j \right) = \sum_{i=1}^{n} \sum_{j=1}^{n} x_i y_j f(e_i, e_j).
$$
令 $ a_{ij} = f(e_i, e_j)(i,j = 1, \cdots, n) $，则：

$$
\begin{aligned}
f(\alpha, \beta) &= \sum_{i=1}^{n} \sum_{j=1}^{n} a_{ij} x_i y_j = \sum_{i=1}^{n} x_i (a_{i1} y_1 + a_{i2} y_2 + \cdots + a_{in} y_n) \\
&=(x_1, x_2, \cdots, x_n) \begin{pmatrix} a_{11} y_1 + a_{12} y_2 + \cdots + a_{1n} y_n \\ a_{21} y_1 + a_{22} y_2 + \cdots + a_{2n} y_n \\ \vdots \\ a_{n1} y_1 + a_{n2} y_2 + \cdots + a_{nn} y_n \end{pmatrix}\\
&=(x_1, x_2, \cdots, x_n) \begin{pmatrix} a_{11} & a_{12} & \cdots & a_{1n} \\ a_{21} & a_{22} & \cdots & a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ a_{n1} & a_{n2} & \cdots & a_{nn} \end{pmatrix} \begin{pmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{pmatrix} = X^T A Y.
\end{aligned}
$$

其中 $ A = (a_{ij})_{n \times n} = (f(e_i, e_j))_{n \times n} $ 称为双线性函数 $ f(\alpha, \beta) $ 在基 $B$​ 下的度量矩阵.

有了双线性函数以后，我们就很好引出二次型的内容了：如果 $\beta=\alpha$​，会发生什么？

在 $B = \{e_1,e_2,\cdots,e_n\}$ 的基下，$\alpha = \sum_{i=1}^{n} x_i e_i$，定义 $g(x_1,\cdots,x_n)=f(\alpha, \alpha)$，则：

$$
\begin{aligned}
g(x_1,\cdots,x_n)= \sum_{i=1}^{n} \sum_{j=1}^{n}a_{ij}x_ix_j
=(x_1, x_2, \cdots, x_n) \begin{pmatrix} a_{11} & a_{12} & \cdots & a_{1n} \\ a_{21} & a_{22} & \cdots & a_{2n} \\ \vdots & \vdots & \ddots & \vdots \\ a_{n1} & a_{n2} & \cdots & a_{nn} \end{pmatrix} \begin{pmatrix} x_1 \\ x_2 \\ \vdots \\ x_n \end{pmatrix} = X^T A X.
\end{aligned}
$$


这样，我们就得到了一个从 $V$ 映射到 $F$ 的函数，也就是我们接下来要讲的二次型。



### 二次型的定义

>$n$ 个元 $x_1,x_2,\ldots,x_n$​ 的二次齐次多项式
>
>$$
>\begin{align*}
>f(x_1,x_2,\ldots,x_n) & = \sum_{i=1}^{n}p_{ii}x_i^2+\sum\limits_{1\leqslant i<j\leqslant n}p_{ij}x_ix_j 
>\end{align*}
>$$
>
>称为数域 $\mathbf{F}$ 上的 $n$ 元二次型. 

本学期研究的主要是实二次型. 若令 $a_{ij}=a_{ji}\enspace(1\leqslant i<j\leqslant n)$​，则二次型可表示为
$$
f(x_1,x_2,\ldots,x_n)=\sum_{i=1}^{n}\sum_{j=1}^{n}a_{ij}x_ix_j=X^\mathrm{T}AX
$$
其中 $X=(x_1,x_2,\ldots,x_n)^\mathrm{T}\in\mathbf{R}^n$，$A=(a_{ij})_{n\times n}$为实对称矩阵，并称对称矩阵 $A$ 为二次型 $f(x_1,x_2,\ldots,x_n)$ 的矩阵.

一个这样的函数可以对应的矩阵是很多的，我们规定二次型对应的矩阵一定是对称矩阵.

再次强调，从本质上来说，二次型实际上是一个 $\mathbf{R}^n\to\mathbf{R}$ 的函数，给一个 $(x_1,\cdots,x_n)$​，输出的就是一个实数，所以不用想得太复杂.



### 矩阵相合的定义与性质

> 我们称 $n$ 阶矩阵 $A$ 相合于 $B$（记作 $A\simeq B$ ），如果存在**可逆矩阵** $C$ 使得 $B=C^\mathrm{T}AC$​​.

让我们回到之前二次型引入的部分，我们发现如果对于向量 $\alpha$ 换一个基 $B'=\{\epsilon_1,\epsilon_2,\cdots,\epsilon_n\}$，$\alpha$ 在 $B'$ 下的坐标表示为 $(y_1,y_2,\cdots,y_n)$， 假设在这个基下 $f(\alpha)=h(y_1,\cdots,y_n)$ 那么可得：
$$
g(x_1,\cdots,x_n)=X^\mathrm{T}AX=f(\alpha)=h(y_1,\cdots,y_n)=Y^\mathrm{T}BY
$$
如果我们有 $X=CY$，就可以得到 $B=C^\mathrm{T}AC$.

- **注意：这里并没有要求 $A,B$ 是实对称矩阵，所以做判断题时务必注意！**

#### 矩阵相合的性质

1. 合同是等价关系（这也正是为什么要求 $C$ 是可逆矩阵）；合同不同于相似，它是一种特殊的相抵；

2. $A\simeq B$ 一般不能得到 $A^m\simeq B^m$（但是$A,B$为实对称矩阵时可以），但如果可逆，我们有 $A^{-1}\simeq B^{-1}$，同时如果$A_1\simeq A_2,B_1\simeq B_2$，则有：

    $$
    \begin{pmatrix}A_1 & O \\ O & B_1​\end{pmatrix} \simeq
    \begin{pmatrix}A_2 & O \\ O & B_2\end{pmatrix}
    $$

3. $A\simeq B$ 表明 $A$ 可以每次做相同的初等行列变换得到 $B$ ，反之亦然. 这实际上就是初等变换法求相合标准形的基本原理，详见教材 260 页小字部分，感兴趣同学可以了解，一般不会要求使用这一方法.

#### Examples

> 1. 已知 $A$ 是一个 $n$ 阶矩阵，证明 $A$ 为反对称矩阵的充要条件是对任意 $n$ 元列向量 $X$ 都有 $X^T A X = 0$;
>
> 2. 若二次型 $f(x_1, x_2, \ldots, x_n) = X^T A X$ 对任意 $n$ 元列向量 $X$ 都有 $f(x_1, x_2, \ldots, x_n) = 0$，证明：$A = O$;
>
> 3. 设二次型 $f(x_1, x_2, \ldots, x_n) = X^T A X$，$g(x_1, x_2, \ldots, x_n) = X^T B X$。证明：若 $f(x_1, x_2, \ldots, x_n) = g(x_1, x_2, \ldots, x_n)$，则 $A = B$​.



> 设 $A \simeq B$，$C \simeq D$，且它们都是 $n$ 阶实对称矩阵，问：$A + C \simeq B + D$ 是否成立.

### 二次标准型的定义和求解

二次型可以视为空间的曲线 / 曲面方程，我们希望把这些方程化为标准形式，类似于相似标准型和相抵标准型，我们希望把二次型对应的矩阵对角化：

由于目前我们讨论的都是实二次型，并且实对称矩阵一定可以相似对角化（实谱定理，下学期会讲），因此我们有下面的定理：

> 任意二次型 $f(X)=X^\mathrm{T}AX$ 总可以通过可逆的线性变换 $X=PY$ （其中 $P$ 可逆）化为标准形，即： $f(X)=X^\mathrm{T}AX\xlongequal{X=PY}Y^\mathrm{T}(P^\mathrm{T}AP)Y=d_1y_1^2+d_2y_2^2+\cdots+d_ny_n^2$.

对于标准二次型的求解，我们有配方法、正交变换法和初等变换法。初等变化法比较复杂，考试一般不做要求；正交变换法来源于正交矩阵逆就是转置，所以我们只要对于实对称矩阵相似对角化即可，然后线代 I 并不会考这个内容。

因此，在这里我们主要介绍配方法：

配方法的思想非常简单，就是利用配方消除混合乘积项，将二次型表示成几个平方和的形式，最后通过坐标变换 $X=CY$（又称仿射变换，其中 $C$ 可逆）化标准形.

#### Examples

> 用配方法把三元二次型：
> $$
> f(x_1,x_2,x_3)=2x_1^2+3x_2^2+x_3^2+4x_1x_2-4x_1x_3-8x_2x_3
> $$
> 化为标准形，并求所用的坐标变换 $X=CY$ 即变换矩阵$C$.



> 如果不能直接配方的话，我们还需要采用换元的方法：
>
> $f = 2x_1x_4 + 2x_2x_3$.



### 相合规范形与惯性定理

对于一个实对称矩阵 $A$，如果我们采用正交变换标准化的话，得到的对角线上的元素就是特征值；

但是如果我们对过渡矩阵整体乘上 $diag(\sqrt{\lambda_1},\cdots,\sqrt{\lambda_n})$，我们就可以得到一个对角线全为 $1, -1, 0$​​ 的矩阵，我么称 $diag(1,\cdots,1,-1,\cdots,-1,0,\cdots,0)$ 这个矩阵为 $A$ 的**相合规范型**.

其中，$+1$ 的个数和 $-1$ 的个数分别叫做 $A$ 的**正惯性系数**和**负惯性系数**.

#### 惯性定理

> 实对称矩阵的相合规范型唯一.

这个定理很显然，因为实对称矩阵的特征值都是固定的，特征值的正负性直接决定了相合规范型.

也就是说，通过正负惯性系数，我们可以将 $n$ 阶的实对称矩阵划分为若干个等价类.



### 正定二次型与正定矩阵的定义

> $n$ 元实二次型 $f(x_1,x_2,\cdots,x_n)=X^TAX$ 称为正定二次型，如果 $\forall X \neq 0,(X \in R^n)$ 恒有 $X^TAX >0$；正定二次型 $X^TAX$ 所对应的矩阵 $A$​ 叫做正定矩阵.

- 注意，**正定矩阵不一定是实对称矩阵！**

**假设一个 $n$ 元二次型对应的实对称矩阵是 $A$，则以下五个命题等价：**

1. $A$ 是正定矩阵
2. $A$ 的正惯性系数为 $n$.
3. $A$ 的特征值均 $>0$.
4. $A$ 可以表示为一个可逆矩阵 $P$ 和它转置的乘积，即 $A=P^TP$，也即 $A$ 的相合规范型是单位矩阵.
5. $A$ 的任意阶主子式均为 $>0$​.

（证明）

> 思考：如果对于负定矩阵，这些等价命题是否还成立？



### 例题选讲

#### 大题

> （2023-2024 学年线性代数I（H）期末）
>
> $f(x,y,z) = 5x^2 + y^2 + tz^2 + 4xy - 2yz - 2xz$，当 $t$ 取何值时，$f(x,y,z)$ 是正定，半正定，不定的？并求不定时的正负惯性系数。



> （2019-2020 学年线性代数I（H）期末）
>
> 已知二次型 $X^TAX = ax_1^2 + ax_2^2 + ax_3^2 + 2x_1x_2 + 2x_1x_3 - 2x_2x_3$ 的秩为 2。
>
> (1) 求实数 $a$ 的值；
>
> (2) 用正交变换 $X = QY$ 将 $X^TAX$ 化为标准形，给出 $Q$​，并求二次型的正、负惯性指数。



> （2018-2019 学年线性代数I（H）期末）
>
> 设实二次型 $f(x_{1},x_{2},x_{3}) = ax_{1}^{2} + 2x_{2}^{2} - 2x_{3}^{2} + 2bx_{1}x_{3}$（$b > 0$），二次型对应的矩阵 $A$ 的特征值之和为 1，特征值之积为 $-12$。
>
> (1) 求参数 $a,\ b$；
>
> (2) 用正交变换将二次型 $f$ 化为标准形，并写出所用的正交变换及标准形；
>
> (3) 判断此二次型是否是正定二次型。



#### 判断正误

> 设 $A, B$ 为 $n$ 阶正定矩阵。证明：$A + B$ 的最大特征值大于 $A$​ 的最大特征值。



> 设 $\lambda_1$ 和 $\mu_1$ 分别是 $n$ 阶实对称矩阵 $A$ 和 $B$ 的最小特征值。证明：$A + B$ 的最小特征值大于或等于 $\lambda_1 + \mu_1$​。



> 设 $A$ 是半正定矩阵，$C$ 是可逆矩阵，证明：$C^T AC$​ 也是半正定矩阵。



> 设 $A$ 是实对称矩阵，$B$ 是正定矩阵。证明：存在可逆阵 $C$，使得 $C^T A C$ 和 $C^T B C$ 都成对角形。



> （2019-2020 学年线性代数I（H）期末）
>
> 判断正误：设 $x \in \mathbb{R}^n$，对任意 $\lambda \in \mathbb{R}$，$E + \lambda xx^{\rm T}$​ 为正定矩阵。



> （2023-2024 学年线性代数I（H）期末）
>
> 判断正误：$A$ 是 $m$ 阶实正定矩阵，$C$ 为 $m \times n$ 的实矩阵，$\mathrm{r}(C) = m$，则 $C^T A C$ 也正定。

